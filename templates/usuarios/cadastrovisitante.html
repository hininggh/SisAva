{% extends 'base.html' %}
{% load custom_filters %}
{% block content %}
<div class="container mt-5">
    <h2>{% if visitante %}Editar Visitante{% else %}Cadastrar Novo Visitante{% endif %}</h2>

    <form method="post">
        {% csrf_token %}

        <!-- Formulário principal para dados do visitante -->
        <div class="form-group">
            {{ form.nome.label_tag }}
            {{ form.nome }}
            {% if form.nome.errors %}
                <div class="text-danger">{{ form.nome.errors }}</div>
            {% endif %}
        </div>

        <div class="form-group">
            {{ form.email.label_tag }}
            {{ form.email }}
            {% if form.email.errors %}
                <div class="text-danger">{{ form.email.errors }}</div>
            {% endif %}
        </div>

        <div class="form-group">
            {{ form.instituicao.label_tag }}
            {{ form.instituicao }}
            {% if form.instituicao.errors %}
                <div class="text-danger">{{ form.instituicao.errors }}</div>
            {% endif %}
        </div>

        <div class="form-group">
            {{ form.senha.label_tag }}
            {{ form.senha }}
            {% if form.senha.errors %}
                <div class="text-danger">{{ form.senha.errors }}</div>
            {% endif %}
        </div>

        <div class="form-group">
            {{ form.data_inicial.label_tag }}
            {{ form.data_inicial }}
            {% if form.data_inicial.errors %}
                <div class="text-danger">{{ form.data_inicial.errors }}</div>
            {% endif %}
        </div>

        <div class="form-group">
            {{ form.data_final.label_tag }}
            {{ form.data_final }}
            {% if form.data_final.errors %}
                <div class="text-danger">{{ form.data_final.errors }}</div>
            {% endif %}
        </div>

        <!-- Formulário para associar cursos ao visitante -->
        <h3 class="mt-4">Cursos com Acesso</h3>
        <div class="form-group">
            {{ curso_form.cursos_acesso.label_tag }}
            <div class="form-check">
                {% for curso in curso_form.cursos_acesso %}
                    <label class="form-check-label">
                        {{ curso.tag }} {{ curso.choice_label }}
                    </label>
                {% endfor %}
            </div>
            {% if curso_form.cursos_acesso.errors %}
                <div class="text-danger">{{ curso_form.cursos_acesso.errors }}</div>
            {% endif %}
        </div>

        <!-- Botões de ação -->
        <button type="submit" class="btn btn-primary">Salvar Alterações</button>
        <a href="{% if curso_id %}{% url 'editar_curso' curso_id=curso_id %}{% else %}{% url 'gerenciarvisitantes' %}{% endif %}" class="btn btn-secondary">Cancelar</a>
    </form>
</div>
{% endblock %}
